# ========================================
# AI Chatbot Service - Environment Variables
# ========================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to git - it contains secrets!

# ========================================
# Server Configuration
# ========================================
NODE_ENV=development
PORT=3001
LOG_LEVEL=debug

# ========================================
# AI Provider Configuration
# ========================================
# Choose ONE AI provider and uncomment its section

# Option 1: OpenAI (Recommended for production)
AI_PROVIDER=openai
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
OPENAI_MODEL=gpt-4-turbo-preview
# For production with HIPAA: gpt-4-turbo-preview
# For development/testing: gpt-3.5-turbo
# OPENAI_ORGANIZATION_ID=org-xxxxxxxxxxxxx  # Optional, for Business tier

# Option 2: Google Gemini (Free tier available)
# AI_PROVIDER=gemini
# GEMINI_API_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# GEMINI_MODEL=gemini-pro

# Option 3: Anthropic Claude
# AI_PROVIDER=claude
# ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# CLAUDE_MODEL=claude-3-sonnet-20240229

# Option 4: Self-hosted (Ollama)
# AI_PROVIDER=ollama
# OLLAMA_BASE_URL=http://localhost:11434
# OLLAMA_MODEL=llama3:70b

# AI Configuration
AI_MAX_TOKENS=1000
AI_TEMPERATURE=0.7
AI_TIMEOUT_MS=30000

# ========================================
# Database Configuration
# ========================================

# MongoDB (for chat history and screening data)
MONGODB_URI=mongodb://admin:admin@localhost:27017/chatbot?authSource=admin
MONGODB_MAX_POOL_SIZE=10
MONGODB_MIN_POOL_SIZE=2

# Redis (for session state and caching)
REDIS_URL=redis://:admin@localhost:6379
REDIS_DB=0
REDIS_KEY_PREFIX=chatbot:
REDIS_SESSION_TTL_SECONDS=1800  # 30 minutes

# PostgreSQL (existing FHIR database)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=hapi02
POSTGRES_USER=admin
POSTGRES_PASSWORD=admin

# ========================================
# FHIR Server Configuration
# ========================================
FHIR_BASE_URL=http://localhost:8082/fhir
FHIR_VERSION=R4
FHIR_TIMEOUT_MS=10000

# ========================================
# Authentication Configuration
# ========================================
# Keycloak settings
KEYCLOAK_URL=http://localhost:8081
KEYCLOAK_REALM=clinic
KEYCLOAK_CLIENT_ID=clinic-fe
KEYCLOAK_CLIENT_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# JWT settings
JWT_ISSUER=http://localhost:8081/realms/clinic
JWT_AUDIENCE=clinic-fe
JWT_ALGORITHMS=RS256

# ========================================
# WebSocket Configuration
# ========================================
WEBSOCKET_CORS_ORIGIN=http://localhost:4200
WEBSOCKET_PATH=/socket.io
WEBSOCKET_PING_TIMEOUT=60000
WEBSOCKET_PING_INTERVAL=25000

# ========================================
# Rate Limiting Configuration
# ========================================
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_ENABLED=true

# ========================================
# Screening Agent Configuration
# ========================================
SCREENING_ENABLED=true
SCREENING_MAX_SYMPTOMS=10
SCREENING_TIMEOUT_MS=300000  # 5 minutes
SCREENING_AUTO_SAVE=true

# Risk scoring thresholds (0-10 scale)
RISK_SCORE_EMERGENCY=8
RISK_SCORE_URGENT=5
RISK_SCORE_ROUTINE=3

# ========================================
# Notification Configuration (Optional)
# ========================================
# Email notifications for urgent cases
EMAIL_ENABLED=false
EMAIL_PROVIDER=sendgrid  # sendgrid, ses, smtp
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
EMAIL_FROM=noreply@clinic.ai
EMAIL_FROM_NAME=Clinic AI

# SMS notifications (optional)
SMS_ENABLED=false
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_PHONE_NUMBER=+1234567890

# ========================================
# Monitoring & Logging Configuration
# ========================================
# Logging
LOG_FORMAT=json  # json or pretty
LOG_DESTINATION=console  # console, file, or both
LOG_FILE_PATH=./logs/chatbot.log

# Error tracking (optional)
SENTRY_ENABLED=false
SENTRY_DSN=https://xxxxxxxxxxxxx@xxxxx.ingest.sentry.io/xxxxx
SENTRY_ENVIRONMENT=development

# Metrics (optional)
METRICS_ENABLED=false
METRICS_PORT=9090

# ========================================
# Security Configuration
# ========================================
# Encryption
ENCRYPTION_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxx  # 32-character key for encrypting sensitive data
ENCRYPTION_ALGORITHM=aes-256-gcm

# Content moderation
CONTENT_MODERATION_ENABLED=true
PROFANITY_FILTER_ENABLED=true

# Session security
SESSION_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxx  # Random string for session signing
COOKIE_SECURE=false  # Set to true in production with HTTPS

# ========================================
# Feature Flags
# ========================================
FEATURE_CHAT_ENABLED=true
FEATURE_SCREENING_ENABLED=true
FEATURE_APPOINTMENT_BOOKING_ENABLED=true
FEATURE_VOICE_INPUT_ENABLED=false
FEATURE_MULTILINGUAL_ENABLED=false

# ========================================
# Development/Testing Configuration
# ========================================
# Mock AI responses (for testing without API calls)
MOCK_AI_ENABLED=false
MOCK_AI_DELAY_MS=1000

# Seed data for development
SEED_DATA_ENABLED=false

# Debug mode
DEBUG_MODE=true
DEBUG_SHOW_PROMPTS=true
DEBUG_LOG_AI_REQUESTS=true

# ========================================
# Performance Configuration
# ========================================
# Caching
CACHE_ENABLED=true
CACHE_TTL_SECONDS=300
CACHE_PATIENT_CONTEXT=true

# Connection pooling
HTTP_MAX_CONNECTIONS=100
HTTP_KEEP_ALIVE=true

# ========================================
# Compliance Configuration
# ========================================
# HIPAA compliance settings
HIPAA_AUDIT_ENABLED=true
HIPAA_ENCRYPT_PHI=true
HIPAA_LOG_ACCESS=true

# Data retention
DATA_RETENTION_DAYS=90  # Chat history retention
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years for HIPAA

# Patient consent
REQUIRE_CONSENT=true
CONSENT_VERSION=1.0

# ========================================
# Backup Configuration (Optional)
# ========================================
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM (cron format)
BACKUP_DESTINATION=s3://your-bucket/chatbot-backups
AWS_ACCESS_KEY_ID=xxxxxxxxxxxxxxxxxxxxx
AWS_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
AWS_REGION=us-east-1

# ========================================
# Documentation
# ========================================
# For detailed setup instructions, see:
# - QUICK_START_GUIDE.md
# - AI_CHATBOT_IMPLEMENTATION_PLAN.md
# - AI_PROVIDER_COMPARISON.md
#
# For environment-specific configs:
# - Development: Copy to .env.development
# - Staging: Copy to .env.staging
# - Production: Copy to .env.production
